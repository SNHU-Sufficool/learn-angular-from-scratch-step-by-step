{"ast":null,"code":"var _a, _b;\nimport { __decorate, __metadata } from \"tslib\";\nimport { QuestionsService } from \"../services/questions.service\";\nimport { AnswersService } from \"../services/answers.service\";\nimport { DeleteQuestionModalComponent } from \"./delete-question/delete-question-modal.component\";\nimport { NewQuestionModalComponent } from \"./new-question/new-question-modal.component\";\nimport { Component } from \"@angular/core\";\nlet CategoryQuestionsComponent = class CategoryQuestionsComponent {\n  route;\n  questionsService;\n  answersService;\n  dialog;\n  questions;\n  categoryTitle;\n  categorySlug;\n  constructor(route, questionsService, answersService, dialog) {\n    this.route = route;\n    this.questionsService = questionsService;\n    this.answersService = answersService;\n    this.dialog = dialog;\n  }\n  ngOnInit() {\n    this.route.data.subscribe(routeData => {\n      let data = routeData[\"data\"];\n      if (data) {\n        this.questions = data.questions;\n        this.categoryTitle = data.category_title;\n        this.categorySlug = data.category_slug;\n      }\n    });\n  }\n  getQuestions() {\n    this.questionsService.getQuestionsByCategory(this.categorySlug).then(questions => this.questions = questions);\n  }\n  openNewQuestionModal(categorySlug) {\n    let dialogRef = this.dialog.open(NewQuestionModalComponent, {\n      data: {\n        categorySlug: categorySlug\n      }\n    });\n    dialogRef.afterClosed().subscribe(question => {\n      if (question) {\n        this.addQuestionToList(question);\n      }\n    });\n  }\n  delete(questionId) {\n    let dialogRef = this.dialog.open(DeleteQuestionModalComponent, {\n      data: {\n        questionId: questionId\n      }\n    });\n    dialogRef.afterClosed().subscribe(confirm => {\n      if (confirm) {\n        // refresh the questions list\n        var index = this.questions.findIndex(question => question.id === questionId);\n        this.questions.splice(index, 1);\n        // TODO: evaluar cambiar esto por un operation method en loopback.\n        this.answersService.getAnswers(questionId).then(answers => {\n          for (let answer of answers) {\n            this.answersService.deleteAnswer(answer.id);\n          }\n        });\n      }\n    });\n  }\n  addQuestionToList(question) {\n    this.questions.push(question);\n  }\n  addPositiveVote(question) {\n    question.positiveVotes += 1;\n    this.questionsService.updateQuestion(question);\n  }\n  addNegativeVote(question) {\n    question.negativeVotes += 1;\n    this.questionsService.updateQuestion(question);\n  }\n};\nCategoryQuestionsComponent = __decorate([Component({\n  selector: \"category-questions\",\n  styleUrls: [\"./category-questions.scss\"],\n  templateUrl: \"./category-questions.component.html\"\n}), __metadata(\"design:paramtypes\", [typeof (_a = typeof ActivatedRoute !== \"undefined\" && ActivatedRoute) === \"function\" ? _a : Object, QuestionsService, AnswersService, typeof (_b = typeof MatDialog !== \"undefined\" && MatDialog) === \"function\" ? _b : Object])], CategoryQuestionsComponent);\nexport { CategoryQuestionsComponent };","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}